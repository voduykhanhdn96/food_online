{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/GitHub/food_online/src/app/pages/ViewOrders/OrderDetailModal.jsx\",\n    _s = $RefreshSig$();\n\nimport { forwardRef, useImperativeHandle, useMemo, useState } from \"react\";\nimport { Button, Grid, Modal, Dropdown } from \"semantic-ui-react\";\nimport dayjs from \"dayjs\";\nimport { AgGridReact } from \"ag-grid-react/lib/agGridReact\";\nimport OrderInforField from \"./../../components/OrderInforField\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { changeStatusOrder, cancelOrder } from \"../../store/actions/admin-action\";\nimport useToast from \"../../hooks/useToast\";\nimport { useHistory } from \"react-router-dom\";\nimport { useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst options = [{\n  key: 1,\n  text: \"Confirmed\",\n  value: \"Confirmed\"\n}, {\n  key: 2,\n  text: \"Sent To Kitchen\",\n  value: \"Sent To Kitchen\"\n}, {\n  key: 3,\n  text: \"Ready for Pickup\",\n  value: \"Ready for Pickup\"\n}];\nconst OrderDetailModal = /*#__PURE__*/forwardRef(_c = _s((props, ref) => {\n  _s();\n\n  const [isOpen, setIsOpen] = useState(false);\n  const [isChangeStatus, setIsChangeStatus] = useState(false);\n  const [order, setOrder] = useState([]);\n  const notification = useSelector(state => state.notification);\n  const {\n    toastError\n  } = useToast();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (isChangeStatus) {\n      if (notification.status === \"completed\" && !notification.error) {\n        history.go(0);\n      }\n\n      if (notification.status === \"completed\" && notification.error) {\n        toastError(notification.error);\n        setIsChangeStatus(false);\n      }\n    }\n  }, [history, isChangeStatus, notification.error, notification, toastError]);\n  useImperativeHandle(ref, () => ({\n    open(id) {\n      setIsOpen(true);\n      const orderTemp = props.listOrder.filter(item => item.orderId === id).map(filteredItem => {\n        return filteredItem;\n      });\n      setOrder(orderTemp[0]);\n    }\n\n  }));\n  const columnDefs = useMemo(() => [{\n    field: \"customerName\",\n    minWidth: 100\n  }, {\n    field: \"price\"\n  }, {\n    field: \"amount\"\n  }, {\n    field: \"price\"\n  }], []);\n  const defaultColDef = useMemo(() => ({\n    resizable: false,\n    sortable: true\n  }), []);\n  const {\n    orderId,\n    status,\n    customerId,\n    customerName,\n    customerPhoneNumber,\n    itemsInCart,\n    orderTime,\n    shopId\n  } = order;\n\n  const changeStatus = (e, data) => {\n    setIsChangeStatus(true);\n    dispatch(changeStatusOrder(orderId, data.value, customerId, shopId));\n  };\n\n  const deliverOrder = () => {\n    setIsChangeStatus(true);\n    dispatch(changeStatusOrder(orderId, \"Delivered\", customerId, shopId));\n  };\n\n  const cancelledOrder = () => {\n    dispatch(cancelOrder(orderId, customerId));\n    setIsChangeStatus(true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    onClose: () => setIsOpen(false),\n    onOpen: () => setIsOpen(true),\n    open: isOpen,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      children: `Order #${orderId}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Content, {\n      image: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Description, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"order-info\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            children: [/*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 2,\n              children: /*#__PURE__*/_jsxDEV(OrderInforField, {\n                title: \"Order No\",\n                label: orderId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 3,\n              children: /*#__PURE__*/_jsxDEV(OrderInforField, {\n                title: \"Order Time\",\n                label: dayjs(orderTime).format(\"MM/DD/YYYY HH:mm\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 2,\n              children: /*#__PURE__*/_jsxDEV(OrderInforField, {\n                title: \"Customer Name\",\n                label: customerName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 2,\n              children: /*#__PURE__*/_jsxDEV(OrderInforField, {\n                title: \"Customer Phone\",\n                label: customerPhoneNumber\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Grid.Column, {\n              width: 3,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"info-field\",\n                children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                  children: \"Change Status\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n                  search: true,\n                  selection: true,\n                  defaultValue: status,\n                  wrapSelection: false,\n                  onChange: changeStatus,\n                  options: options,\n                  placeholder: \"Choose an option\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"order-items ag-theme-material\",\n          style: {\n            height: 240\n          },\n          children: /*#__PURE__*/_jsxDEV(AgGridReact, {\n            reactUi: \"true\",\n            className: \"ag-theme-material\",\n            animateRows: \"true\",\n            columnDefs: columnDefs,\n            defaultColDef: defaultColDef,\n            enableRangeSelection: \"true\",\n            rowData: itemsInCart,\n            rowSelection: \"multiple\",\n            suppressRowClickSelection: \"true\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Actions, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        color: \"black\",\n        onClick: () => setIsOpen(false),\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        content: \"Cancel Order\",\n        labelPosition: \"left\",\n        icon: \"close\",\n        onClick: cancelledOrder,\n        color: \"red\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: deliverOrder,\n        content: \"Complete Order\",\n        labelPosition: \"right\",\n        icon: \"checkmark\",\n        positive: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n}, \"WDn6BfBT+GZ/nWmOOY6nhyyq/Wc=\", false, function () {\n  return [useSelector, useToast, useHistory, useDispatch, useImperativeHandle];\n}));\n_c2 = OrderDetailModal;\nexport default OrderDetailModal;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"OrderDetailModal$forwardRef\");\n$RefreshReg$(_c2, \"OrderDetailModal\");","map":{"version":3,"sources":["/Users/mac/Documents/GitHub/food_online/src/app/pages/ViewOrders/OrderDetailModal.jsx"],"names":["forwardRef","useImperativeHandle","useMemo","useState","Button","Grid","Modal","Dropdown","dayjs","AgGridReact","OrderInforField","useDispatch","useSelector","changeStatusOrder","cancelOrder","useToast","useHistory","useEffect","options","key","text","value","OrderDetailModal","props","ref","isOpen","setIsOpen","isChangeStatus","setIsChangeStatus","order","setOrder","notification","state","toastError","history","dispatch","status","error","go","open","id","orderTemp","listOrder","filter","item","orderId","map","filteredItem","columnDefs","field","minWidth","defaultColDef","resizable","sortable","customerId","customerName","customerPhoneNumber","itemsInCart","orderTime","shopId","changeStatus","e","data","deliverOrder","cancelledOrder","format","height"],"mappings":"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","sourcesContent":["import { forwardRef, useImperativeHandle, useMemo, useState } from \"react\";\nimport { Button, Grid, Modal, Dropdown } from \"semantic-ui-react\";\nimport dayjs from \"dayjs\";\nimport { AgGridReact } from \"ag-grid-react/lib/agGridReact\";\nimport OrderInforField from \"./../../components/OrderInforField\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  changeStatusOrder,\n  cancelOrder,\n} from \"../../store/actions/admin-action\";\nimport useToast from \"../../hooks/useToast\";\nimport { useHistory } from \"react-router-dom\";\nimport { useEffect } from \"react\";\nconst options = [\n  { key: 1, text: \"Confirmed\", value: \"Confirmed\" },\n  { key: 2, text: \"Sent To Kitchen\", value: \"Sent To Kitchen\" },\n  { key: 3, text: \"Ready for Pickup\", value: \"Ready for Pickup\" },\n];\n\nconst OrderDetailModal = forwardRef((props, ref) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isChangeStatus, setIsChangeStatus] = useState(false);\n  const [order, setOrder] = useState([]);\n  const notification = useSelector((state) => state.notification);\n  const { toastError } = useToast();\n  const history = useHistory();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (isChangeStatus) {\n      if (notification.status === \"completed\" && !notification.error) {\n        history.go(0);\n      }\n      if (notification.status === \"completed\" && notification.error) {\n        toastError(notification.error);\n        setIsChangeStatus(false);\n      }\n    }\n  }, [history, isChangeStatus, notification.error, notification, toastError]);\n\n  useImperativeHandle(ref, () => ({\n    open(id) {\n      setIsOpen(true);\n      const orderTemp = props.listOrder\n        .filter((item) => item.orderId === id)\n        .map((filteredItem) => {\n          return filteredItem;\n        });\n      setOrder(orderTemp[0]);\n    },\n  }));\n\n  const columnDefs = useMemo(\n    () => [\n      { field: \"customerName\", minWidth: 100 },\n      { field: \"price\" },\n      { field: \"amount\" },\n      { field: \"price\" },\n    ],\n    []\n  );\n\n  const defaultColDef = useMemo(\n    () => ({\n      resizable: false,\n      sortable: true,\n    }),\n    []\n  );\n\n  const {\n    orderId,\n    status,\n    customerId,\n    customerName,\n    customerPhoneNumber,\n    itemsInCart,\n    orderTime,\n    shopId,\n  } = order;\n\n  const changeStatus = (e, data) => {\n    setIsChangeStatus(true);\n    dispatch(changeStatusOrder(orderId, data.value, customerId, shopId));\n  };\n\n  const deliverOrder = () => {\n    setIsChangeStatus(true);\n    dispatch(changeStatusOrder(orderId, \"Delivered\", customerId, shopId));\n  };\n\n  const cancelledOrder = () => {\n    dispatch(cancelOrder(orderId, customerId));\n    setIsChangeStatus(true);\n  };\n\n  return (\n    <Modal\n      onClose={() => setIsOpen(false)}\n      onOpen={() => setIsOpen(true)}\n      open={isOpen}\n    >\n      <Modal.Header>{`Order #${orderId}`}</Modal.Header>\n      <Modal.Content image>\n        <Modal.Description>\n          <div className=\"order-info\">\n            <Grid container>\n              <Grid.Column width={2}>\n                <OrderInforField\n                  title=\"Order No\"\n                  label={orderId}\n                ></OrderInforField>\n              </Grid.Column>\n              <Grid.Column width={3}>\n                <OrderInforField\n                  title=\"Order Time\"\n                  label={dayjs(orderTime).format(\"MM/DD/YYYY HH:mm\")}\n                ></OrderInforField>\n              </Grid.Column>\n              <Grid.Column width={2}>\n                <OrderInforField\n                  title=\"Customer Name\"\n                  label={customerName}\n                ></OrderInforField>\n              </Grid.Column>\n              <Grid.Column width={2}>\n                <OrderInforField\n                  title=\"Customer Phone\"\n                  label={customerPhoneNumber}\n                ></OrderInforField>\n              </Grid.Column>\n              <Grid.Column width={3}>\n                <div className=\"info-field\">\n                  <h5>Change Status</h5>\n                  <Dropdown\n                    search\n                    selection\n                    defaultValue={status}\n                    wrapSelection={false}\n                    onChange={changeStatus}\n                    options={options}\n                    placeholder=\"Choose an option\"\n                  />\n                </div>\n              </Grid.Column>\n            </Grid>\n          </div>\n          <div\n            className=\"order-items ag-theme-material\"\n            style={{ height: 240 }}\n          >\n            <AgGridReact\n              reactUi=\"true\"\n              className=\"ag-theme-material\"\n              animateRows=\"true\"\n              columnDefs={columnDefs}\n              defaultColDef={defaultColDef}\n              enableRangeSelection=\"true\"\n              rowData={itemsInCart}\n              rowSelection=\"multiple\"\n              suppressRowClickSelection=\"true\"\n            />\n          </div>\n        </Modal.Description>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button color=\"black\" onClick={() => setIsOpen(false)}>\n          Close\n        </Button>\n        <Button\n          content=\"Cancel Order\"\n          labelPosition=\"left\"\n          icon=\"close\"\n          onClick={cancelledOrder}\n          color=\"red\"\n        />\n        <Button\n          onClick={deliverOrder}\n          content=\"Complete Order\"\n          labelPosition=\"right\"\n          icon=\"checkmark\"\n          positive\n        />\n      </Modal.Actions>\n    </Modal>\n  );\n});\n\nexport default OrderDetailModal;\n"]},"metadata":{},"sourceType":"module"}